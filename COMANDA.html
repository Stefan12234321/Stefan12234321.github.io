<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SmartMove - Cerere ofertÄƒ</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f7f7f7; color: #222; }
    header { background:#1976d2; color:white; padding:14px 0; text-align:center; }
    nav { background:#125ca1; display:flex; justify-content:center; gap:20px; padding:10px 0; }
    nav a { color:white; text-decoration:none; font-weight:bold; }
    nav a:hover { text-decoration:underline; }
    .container { max-width:800px; margin:20px auto; background:#fff; padding:18px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.08); }
    label { display:block; margin-top:10px; font-weight:600; }
    input[type="text"], input[type="number"] { width:100%; padding:8px; margin-top:6px; box-sizing:border-box; border:1px solid #ddd; border-radius:4px; }
    button { margin-top:10px; padding:10px 14px; border:none; background:#1976d2; color:#fff; border-radius:6px; cursor:pointer; }
    button:hover { background:#125ca1; }
    table { width:100%; margin-top:10px; border-collapse:collapse; }
    th, td { border:1px solid #ddd; padding:6px; text-align:center; }
    th { background:#e3f2fd; }
    .deleteBtn { background:#c62828; color:white; border:none; border-radius:4px; cursor:pointer; padding:6px 10px; }
    .deleteBtn:hover { background:#b71c1c; }
    .result { margin-top:20px; background:#f0f8ff; padding:12px; border-radius:6px; }
    .totalRow { display:flex; justify-content:space-between; align-items:center; gap:10px; margin-top:8px; }
    .payBtn { background:#2e7d32; }
    .payBtn[disabled] { background:#9e9e9e; cursor:not-allowed; }
  </style>
</head>
<body>
  <header>
    <h1>SmartMove</h1>
    <p>SoluÈ›ia inteligentÄƒ pentru mutÄƒri È™i transport bricolaje</p>
  </header>

  <nav>
    <a href="INCERCARE_SITE.html">AcasÄƒ</a>
    <a href="COMANDA.html">ComandÄƒ</a>
  </nav>

  <div class="container">
    <h2>CalculeazÄƒ automat costul transportului</h2>

    <label>Punct de plecare</label>
    <input id="start" type="text" placeholder="Ex: BucureÈ™ti, PiaÈ›a Unirii">

    <label>Punct de destinaÈ›ie</label>
    <input id="end" type="text" placeholder="Ex: Cluj-Napoca, Str. Memorandumului">

    <label>Greutate totalÄƒ estimatÄƒ (kg)</label>
    <input id="greutate" type="number" min="0" max="1500" placeholder="max. 1500 kg">

    <h3>Corpurile de transportat</h3>
    <div style="display:flex; gap:10px;">
      <input id="lungime" type="number" placeholder="L (m)" step="0.01" min="0">
      <input id="latime" type="number" placeholder="l (m)" step="0.01" min="0">
      <input id="inaltime" type="number" placeholder="h (m)" step="0.01" min="0">
      <button type="button" onclick="adaugaCorp()">AdaugÄƒ</button>
    </div>

    <table id="corpuriTable">
      <thead>
        <tr>
          <th>#</th>
          <th>L (m)</th>
          <th>l (m)</th>
          <th>h (m)</th>
          <th>Volum (mÂ³)</th>
          <th>È˜terge</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div style="display:flex; gap:10px; margin-top:12px;">
      <button id="calcDist" type="button">CalculeazÄƒ distanÈ›a È™i costul</button>
      <button id="resetAll" type="button" style="background:#ff9800;">ReseteazÄƒ tot</button>
    </div>

    <div class="result" id="rezultat" style="display:none;">
      <p><strong>DistanÈ›Äƒ:</strong> <span id="distText"></span> km</p>
      <p><strong>Volum total:</strong> <span id="volumText"></span> mÂ³</p>
      <div class="totalRow">
        <div>
          <strong>Cost estimativ:</strong> <span id="costText"></span> lei
        </div>
        <div>
          <strong>SumÄƒ de platÄƒ:</strong> <span id="sumPlat">0.00</span> lei
        </div>
      </div>
      <div style="margin-top:12px; display:flex; gap:10px;">
        <button id="sendBtn" class="payBtn" disabled>Trimite cererea</button>
        <button id="editBtn" type="button">RevizuieÈ™te</button>
      </div>
    </div>
  </div>

  <script>
    let corpuri = [];

    function adaugaCorp() {
      const L = parseFloat(document.getElementById("lungime").value);
      const l = parseFloat(document.getElementById("latime").value);
      const h = parseFloat(document.getElementById("inaltime").value);
      if (!L || !l || !h) return alert("CompleteazÄƒ toate dimensiunile!");

      const volum = L * l * h;
      corpuri.push({L, l, h, volum});
      afiseazaCorpuri();

      document.getElementById("lungime").value = "";
      document.getElementById("latime").value = "";
      document.getElementById("inaltime").value = "";
      // ascunde rezultatul dacÄƒ era vizibil (trebuie recalculat)
      document.getElementById("rezultat").style.display = "none";
      document.getElementById("sendBtn").disabled = true;
    }

    function stergeCorp(index) {
      corpuri.splice(index, 1);
      afiseazaCorpuri();
      document.getElementById("rezultat").style.display = "none";
      document.getElementById("sendBtn").disabled = true;
    }

    function afiseazaCorpuri() {
      const tbody = document.querySelector("#corpuriTable tbody");
      tbody.innerHTML = "";
      corpuri.forEach((c, i) => {
        tbody.innerHTML += `
          <tr>
            <td>${i + 1}</td>
            <td>${c.L}</td>
            <td>${c.l}</td>
            <td>${c.h}</td>
            <td>${c.volum.toFixed(2)}</td>
            <td><button class="deleteBtn" onclick="stergeCorp(${i})">È˜terge</button></td>
          </tr>`;
      });
    }

    document.getElementById("resetAll").addEventListener("click", () => {
      if (!confirm("È˜tergi toate datele curente?")) return;
      corpuri = [];
      afiseazaCorpuri();
      document.getElementById("start").value = "";
      document.getElementById("end").value = "";
      document.getElementById("greutate").value = "";
      document.getElementById("rezultat").style.display = "none";
      document.getElementById("sendBtn").disabled = true;
    });

    document.getElementById("calcDist").addEventListener("click", function() {
      const start = document.getElementById("start").value.trim();
      const end = document.getElementById("end").value.trim();
      const greutate = parseFloat(document.getElementById("greutate").value) || 0;
      const volumTotal = corpuri.reduce((sum, c) => sum + c.volum, 0);

      if (!start || !end) return alert("CompleteazÄƒ adresele!");
      if (greutate > 1500) return alert("Greutatea totalÄƒ depÄƒÈ™eÈ™te 1500 kg!");
      if (volumTotal > 10) return alert("Volumul total depÄƒÈ™eÈ™te 10 mÂ³!");
      if (corpuri.length === 0) return alert("AdaugÄƒ cel puÈ›in un corp!");

      const service = new google.maps.DistanceMatrixService();
      service.getDistanceMatrix({
        origins: [start],
        destinations: [end],
        travelMode: 'DRIVING',
      }, function(response, status) {
        if (status !== 'OK') {
          alert('Eroare la calcularea distanÈ›ei!');
        } else {
          const element = response.rows[0].elements[0];
          if (element.status !== "OK") {
            alert("Adrese nevalide sau distanÈ›Äƒ indisponibilÄƒ.");
            return;
          }
          const distKm = element.distance.value / 1000;
          const cost = distKm * 4;

          document.getElementById("distText").textContent = distKm.toFixed(2);
          document.getElementById("volumText").textContent = volumTotal.toFixed(2);
          document.getElementById("costText").textContent = cost.toFixed(2);

          // SumÄƒ de platÄƒ (poÈ›i modifica dacÄƒ vrei TVA sau alte taxe)
          document.getElementById("sumPlat").textContent = cost.toFixed(2);

          document.getElementById("rezultat").style.display = "block";
          document.getElementById("sendBtn").disabled = false;
        }
      });
    });

    document.getElementById("sendBtn").addEventListener("click", () => {
      // Aici poÈ›i adÄƒuga logica de trimitere (AJAX / salvare)
      alert("Cererea a fost trimisÄƒ!\nSuma de platÄƒ: " + document.getElementById("sumPlat").textContent + " lei");
      // reseteazÄƒ formularul dupÄƒ trimitere
      corpuri = [];
      afiseazaCorpuri();
      document.getElementById("start").value = "";
      document.getElementById("end").value = "";
      document.getElementById("greutate").value = "";
      document.getElementById("rezultat").style.display = "none";
      document.getElementById("sendBtn").disabled = true;
    });

    document.getElementById("editBtn").addEventListener("click", () => {
      document.getElementById("rezultat").style.display = "none";
      document.getElementById("sendBtn").disabled = true;
    });
  </script>

  <!-- ðŸ”‘ ÃŽnlocuieÈ™te CHEIA_TA_DE_API cu cheia ta realÄƒ -->
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCixDsmIX7PAYaCoxN76QYccRzqFHZqITM"></script>
</body>
</html>
